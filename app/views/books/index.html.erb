<% content_for :title, "Books" %>

<div class="w-full" data-controller="draggable">
  <div id="notice" data-turbo-stream-target="notice">
    <% if notice.present? %>
      <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block"><%= notice %></p>
    <% end %>
  </div>

  <div class="flex justify-between items-center mb-8">
    <h1 class="font-bold text-4xl">Books</h1>
    <%= link_to "New book", new_book_path, class: "rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white block font-medium" %>
  </div>

  <!-- Search Section -->
  <div class="mb-8 bg-white p-6 rounded-xl shadow-lg border border-gray-200">
    <h2 class="text-xl font-semibold mb-4 text-gray-800">Search & Add Books</h2>
    <%= form_with url: search_books_path, method: :get, local: false, data: { controller: "search", action: "submit->search#submit" }, class: "flex gap-3 mb-4" do |form| %>
      <%= form.text_field :query, 
          placeholder: "Search by title or author (e.g., Dune Frank Herbert)", 
          class: "flex-grow p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow",
          value: params[:query] %>
      <%= form.submit "Search", 
          class: "px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors" %>
    <% end %>
    
    <div id="search-results" class="space-y-4">
      <p class="text-gray-500 text-center py-4">Search for books to add to your shelves.</p>
    </div>
  </div>

  <div class="space-y-12">
    <% {
      want_to_read: "Want to Read",
      currently_reading: "Currently Reading",
      read: "Read"
    }.each do |status, title| %>
      <% books = @books.select { |book| book.status == status.to_s } %>
      <%= render "status_section", status: status, title: title, books: books %>
    <% end %>
  </div>
</div>
